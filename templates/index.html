<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gá»£i Ã½ khá»‘i thi - LHU 2026</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { background: #f4f7f6; font-family: 'Times New Roman', serif; }
        .card { border-radius: 15px; border: none; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .btn-lhu { background: #004a99; color: white; }
        .btn-lhu:hover { background: #003366; color: white; }
    </style>
</head>
<body>
<div class="container py-5">
    <div class="text-center mb-5">
        <h1 class="fw-bold text-uppercase" style="color: #004a99;">Há»‡ thá»‘ng Gá»£i Ã½ Khá»‘i thi Äáº¡i há»c</h1>
        <p class="lead">Luáº­n vÄƒn Tháº¡c sÄ© CNTT - TrÆ°Æ¡ng Minh Äiá»‡p - Äáº¡i há»c Láº¡c Há»“ng</p>
    </div>

    <div class="row g-4">
        <div class="col-lg-4">
            <div class="card p-4 h-100">
                <h4 class="mb-4 border-bottom pb-2">ğŸ“Š Äiá»ƒm sá»‘ há»c táº­p</h4>
                <div class="row g-3">
                    <div class="col-6"><label>ToÃ¡n</label><input type="number" id="toan" class="form-control" value="8.5" step="0.1"></div>
                    <div class="col-6"><label>VÄƒn</label><input type="number" id="van" class="form-control" value="6.0" step="0.1"></div>
                    <div class="col-6"><label>LÃ½</label><input type="number" id="ly" class="form-control" value="8.0" step="0.1"></div>
                    <div class="col-6"><label>HÃ³a</label><input type="number" id="hoa" class="form-control" value="7.5" step="0.1"></div>
                    <div class="col-6"><label>Sinh</label><input type="number" id="sinh" class="form-control" value="6.5" step="0.1"></div>
                    <div class="col-6"><label>Anh</label><input type="number" id="anh" class="form-control" value="9.0" step="0.1"></div>
                </div>
                <button onclick="predict()" class="btn btn-lhu w-100 mt-4 py-2 fw-bold">ğŸš€ Gá»¢I Ã KHá»I THI</button>
            </div>
        </div>

        <div class="col-lg-4">
            <div class="card p-4 h-100 text-center">
                <h4 class="mb-4 border-bottom pb-2">ğŸ•¸ï¸ HÃ¬nh thÃ¡i nÄƒng lá»±c</h4>
                <canvas id="radarChart"></canvas>
            </div>
        </div>

        <div class="col-lg-4">
            <div class="card p-4 h-100 text-center">
                <h4 class="mb-4 border-bottom pb-2">ğŸ¯ Káº¿t quáº£ gá»£i Ã½</h4>
                <div id="loading" class="d-none spinner-border text-primary mx-auto my-4"></div>
                <div id="resultArea" class="mt-2">
                    <h2 id="blockName" class="display-4 fw-bold text-success">-</h2>
                    <p id="subInfo" class="text-muted">Nháº¥n dá»± Ä‘oÃ¡n Ä‘á»ƒ xem káº¿t quáº£</p>
                    <canvas id="probChart" class="mt-3"></canvas>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    let radarChart, probChart;

    function initRadar() {
        const ctx = document.getElementById('radarChart').getContext('2d');
        radarChart = new Chart(ctx, {
            type: 'radar',
            data: {
                labels: ['ToÃ¡n', 'VÄƒn', 'LÃ½', 'HÃ³a', 'Sinh', 'Anh'],
                datasets: [{ label: 'Äiá»ƒm sá»‘', data: [8.5, 6, 8, 7.5, 6.5, 9], backgroundColor: 'rgba(0, 74, 153, 0.2)', borderColor: '#004a99' }]
            },
            options: { scales: { r: { min: 0, max: 10 } } }
        });
    }

    async function predict() {
        const scores = {
            toan: document.getElementById('toan').value,
            van: document.getElementById('van').value,
            ly: document.getElementById('ly').value,
            hoa: document.getElementById('hoa').value,
            sinh: document.getElementById('sinh').value,
            anh: document.getElementById('anh').value
        };

        // Cáº­p nháº­t Radar ngay láº­p tá»©c
        radarChart.data.datasets[0].data = Object.values(scores);
        radarChart.update();

        const response = await fetch('/predict', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify(scores)
        });
        
        const res = await response.json();
        if(res.success) {
            document.getElementById('blockName').innerText = res.block;
            document.getElementById('subInfo').innerText = "Äá»™ tin cáº­y cá»§a mÃ´ hÃ¬nh MLP";
            updateProb(res.classes, res.probabilities);
        }
    }

    function updateProb(labels, probs) {
        if(probChart) probChart.destroy();
        const ctx = document.getElementById('probChart').getContext('2d');
        probChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [{ label: 'XÃ¡c suáº¥t (%)', data: probs.map(p => p*100), backgroundColor: '#198754' }]
            }
        });
    }

    window.onload = initRadar;
</script>
</body>
</html>